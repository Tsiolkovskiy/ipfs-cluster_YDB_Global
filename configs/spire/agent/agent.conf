agent {
    data_dir = "/opt/spire/data/agent"
    log_level = "INFO"
    log_format = "text"
    
    # SPIRE server configuration
    server_address = "spire-server"
    server_port = "8081"
    
    # Socket path for workload API
    socket_path = "/tmp/spire-agent/public/api.sock"
    
    # Trust domain
    trust_domain = "gdc.local"
    
    # Trust bundle path (bootstrap certificate)
    trust_bundle_path = "/opt/spire/conf/agent/bootstrap.crt"
    
    # Insecure bootstrap (for development only)
    insecure_bootstrap = true
}

plugins {
    NodeAttestor "join_token" {
        plugin_data {
            token_path = "/opt/spire/conf/agent/token"
        }
    }

    NodeAttestor "docker" {
        plugin_data {
            # Docker socket for container attestation
            docker_socket_path = "/var/run/docker.sock"
        }
    }

    KeyManager "memory" {
        plugin_data {}
    }

    WorkloadAttestor "docker" {
        plugin_data {
            docker_socket_path = "/var/run/docker.sock"
        }
    }

    WorkloadAttestor "unix" {
        plugin_data {
            # Discover workloads by Unix process attributes
        }
    }
}

health_checks {
    listener_enabled = true
    bind_address = "0.0.0.0"
    bind_port = "8080"
    live_path = "/live"
    ready_path = "/ready"
}